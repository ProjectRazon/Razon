# Introduction

User Account Control (UAC) is a security measure introduced in Windows Vista which aims to prevent unauthorised changes to the operating system. It ensures that any such changes require the assent of the administrator or a user who is part of the local administrators group. 

Administrative privileges in Windows are a bit different from those in Linux. Even if an adversary manages to execute some code from an administrator account, this code will *not* run with elevated privileges, unless it was "run as Administrator"-ed.

When an unprivileged user attempts to run a programme as administrator, they will be prompted by UAC to enter the administrator's password. 

![[res/UAC Credentials Prompt.png]]

However, if the user *is* privileged (they are an administrator), they will *still* be prompted with the same UAC prompt, but it will ask them for consent in lieu of a password. Essentially, an administrative user will need to click "Yes" instead of typing their password. 

![[res/UAC Consent Prompt.png]]

What is described so far is the default behaviour. UAC, however, has different *protection levels* which can be configured.

![[res/UAC Protection Levels.png]]

Now there are 3 (two of the options are the same but with different aesthetics) options. The first option, and the most strict, is `Always Notify`. If UAC is set to this, then *any* programme which tries to run with elevated privileges will beget a UAC prompt - including Windows built-in ones. 

Next is the default setting - `Notify me when application try to make changes to my computer`. Under this configuration, regular applications will still cause a UAC prompt to show up whenever run as administrator, however, Windows built-in programmes can be run with elevated privileges without such a prompt. Following is another option which is the exact same as this one, but the UAC prompt will not dim the screen. This is useful for computers for which dimming the screen is not exactly a trifling task.

Finally, the `Never Notify` means that a UAC prompt will never be spawned no matter who is trying to run the application with elevated privileges.

UAC can be bypassed if an adversary already has access to a user account which is part of the local administrators group and UAC is configured to the default setting. 

### Bypassing UAC

There are many tools for bypassing UAC and which one is to be used depends on the Windows build and version. One such tool which has lots of methods for bypassing UAC is [[https://github.com/hfiref0x/UACME|UACMe]]. You will need to build it from source using Visual Studio, meaning that you will need a Windows machine in order to compile it.

