# Introduction

Windows Services allow for the creation of continuously running executable applications. These applications have the ability to be automatically started upon booting, they may be paused and restarted, and they lack a user interface. 

In order for a service to function properly, it needs to be associated with a system or user account. There are a few common built-in system accounts that are used to operate services such as `LocalService`, `NetworkService`, and `LocalSystem`. The following table describes the default secure access rights for accounts on a Windows system:

|Account|Permissions|
|-------|:-----------:|
|Local Authenticated Users <br /> (including `LocalService` and `Network Service`)|`READ_CONTROL`<br /> `SERVICE_ENUMERATE DEPENDENTS` <br /> `SERVICE_INTERROGATE` <br /> `SERVICE_QUERY_CONFIG` <br /> `SERVICE_QUERY_STATUS` <br /> `SERVICE_USER_DEFINED_CONTROL`|
|Remote Authenticated Users | Same as those for Local Authenitcated Users. |
|`LocalSystem`|`READ_CONTROL` <br /> `SERVICE_ENUMERATE DEPENDENTS` <br /> `SERVICE_INTERROGATE` <br /> `SERVICE_PAUSE_CONTINUE` <br /> `SERVICE_QUERY_CONFIG` <br /> `SERVICE_QUERY_STATUS` <br /> `SERVICE_START` <br /> `SERVICE_STOP` <br /> `SERVICE_USER_DEFINED_CONTROL`|
|Administrators|`DELETE` <br /> `READ_CONTROL` <br /> `SERVICE_ALL_ACCESS` <br /> `WRITE_DAC` <br /> `WRITE_OWNER`|

Moreover, a registry entry exists for each service in `HKLM\SYSTEM\CurrentControlSet\Services`.

### Enumeration

In general, manual enumeration of Windows services is a rather cumbersome process, so I suggest that you use a tool for automation such as [[https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS|WinPEAS]].

```powershell
winpeas.exe servicesinfo
```

![[res/WinPEAS Enumerate Services.png]]

The permissions a user has on a specific service can be inspected via the [[https://learn.microsoft.com/en-us/sysinternals/downloads/accesschk|AccessChk]] Windows Utility. 

```powershell
acceschk.exe /accepteula -uwcqv <account> <service> 
```

